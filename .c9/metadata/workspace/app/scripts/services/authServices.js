{"filter":false,"title":"authServices.js","tooltip":"/app/scripts/services/authServices.js","undoManager":{"mark":0,"position":0,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":0,"column":0},"end":{"row":0,"column":79}},"text":"var authServices = angular.module(\"AuthServices\", [\"ngResource\", \"ngCookies\"]);"},{"action":"insertText","range":{"start":{"row":0,"column":79},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":1,"column":0},"end":{"row":63,"column":0}},"lines":["authServices.factory(\"Auth\", ['$resource', '$http', '$window', '$cookies','Utility',","    function($resource, $http, $window, $cookies, Utility) {","        ","        //他の認証方式を実装するときのために残しておく","        var getResource = function(){","            ","            return $resource('api/auth');","        };","        var login = function(data) {","            ","            $http.post('api/login', {mailAddress: data.mailAddress, password: data.password","            }).success(function(data) {","                ","                if (data.remember) {","                    //クッキーに入れる","                    console.log('cookies');","                    $cookies.remembertkn = data.remembertkn;","                }","                $window.location.href = \"https://\"+location.host;","","            }).error(function(data) {","                ","                Utility.errorSticky(data);","            });","        };","        ","        var isLogin = function() {","            ","            $http.post('api/isLogin', {}","            ).success(function(data) {","                ","                return true;","                ","            }).error(function(data) {","                ","                $window.location.href = \"https://\"+location.host;","            });","            ","        };","        ","        return {","                getResource: getResource,","                login: login,","                isLogin: isLogin,","            };","    }","]);","","//自動ログイン機能を追加時に正式に実装する","authServices.factory(\"AutoAuth\", ['$window', '$http', '$q',","    function($window, $http, $q) {","        var deferred = $q.defer();","        //クッキーからトークンを取得","        $http.post('api/auth', {}","        ).success(function(data){","            ","            return deferred.promise;","            ","        }).error(function(data) {","            $window.location.href = \"https://\"+location.host;","        });","    }"]},{"action":"insertText","range":{"start":{"row":63,"column":0},"end":{"row":63,"column":3}},"text":"]);"}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":8,"column":10},"end":{"row":8,"column":10},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1407892080284,"hash":"6f4d8a7d4667c1de49c8ded2ccb99ee67b890f60"}